<!DOCTYPE html>

<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<script src="https://cdn1.lncld.net/static/js/av-min-1.5.0.js"></script>
<title>基于Web技术的Emacs翻译插件</title>


        <link rel="stylesheet" href="//manateelazycat.github.io/styles/font.css">
        <link rel="stylesheet" media="screen and (min-width: 600px)" href="//manateelazycat.github.io/styles/post.css">
        <link rel="stylesheet" media="screen and (max-width: 600px)" href="//manateelazycat.github.io/styles/post_mobile.css">
        <link rel="stylesheet" media="screen and (min-width: 600px)" href="//manateelazycat.github.io/styles/navigatebar.css">
        <link rel="stylesheet" media="screen and (max-width: 600px)" href="//manateelazycat.github.io/styles/navigatebar_mobile.css">
        <link rel="stylesheet" href="//manateelazycat.github.io/theme/highlight.css">
    </head>
    <body>
        <div class="navigatebar">
    <div class="navigatebar-button navigatebar-mine">
        <a href="//manateelazycat.github.io/index.html">ManateeLazyCat</a>
    </div>
    <div class="navigatebar-button">
        <a href="//manateelazycat.github.io/tags.html">Tags</a>
    </div>
    <div class="navigatebar-button">
        <a href="//manateelazycat.github.io/projects.html">Projects</a>
    </div>
    <div class="navigatebar-button">
        <a href="//manateelazycat.github.io/feed.xml">Feeds</a>
    </div>
    <div class="navigatebar-button navigatebar-about">
        <a href="//manateelazycat.github.io/about.html">About</a>
    </div>
</div>

        <div class="content-area">
            <div class="title">
                基于Web技术的Emacs翻译插件
            </div>
            <div class="category-area">
                「
                <a href="//manateelazycat.github.io/tags.html#Emacs">
                    <div class="category">
                        Emacs
                    </div>
                </a>
                」
            </div>
            <div class="char-counter">
                字数1194 2021-11-14
            </div>
            <div class="content">
                <h2 id="关于popweb">关于popweb</h2>
<p>我写的<a href="https://github.com/manateelazycat/sdcv">sdcv</a>应该是Emacs里面最早的弹窗翻译插件，一直想要一个Web版的弹窗翻译插件，需要满足如下要求：</p>

<ol>
  <li>用Web技术来绘制美观的界面</li>
  <li>长期稳定使用，不需要破解翻译网站的API或者单独申请Key</li>
  <li>支持例句显示和自动发声</li>
  <li>支持光标处单词自动提取，支持选中状态</li>
  <li>支持代理配置，国内有道直连，国外翻译服务走代理</li>
</ol>

<p>苦于没有想好第二条需求的方案，迟迟没有开动，今天突然想到其实可以利用CSS来隐藏不要的广告，这样既可以保证界面干净，又不用破解每个翻译网站的API。</p>

<p>得益于<a href="https://github.com/emacs-eaf/emacs-application-framework">Emacs Application Framework</a>过去2年的研究，我直接提取了EAF浏览器相关的代码，很快就实现了Web版的弹窗翻译插件。</p>

<h3 id="安装">安装</h3>
<ol>
  <li>从你的操作系统中安装PyQt5(注意不要用PIP安装PyQt5, PIP版的有bug会导致浏览器崩溃)</li>
  <li>下载popweb仓库代码: https://github.com/manateelazycat/popweb</li>
  <li>在你的配置文件 <code class="language-plaintext highlighter-rouge">~/.emacs</code> 中添加以下配置
    <div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'load-path</span> <span class="s">"&lt;path-to-popweb&gt;"</span><span class="p">)</span> <span class="c1">; add popweb to your load-path</span>
<span class="p">(</span><span class="nb">require</span> <span class="ss">'popweb-dict-bing</span><span class="p">)</span>
<span class="p">(</span><span class="nb">require</span> <span class="ss">'popweb-dict-youdao</span><span class="p">)</span>
<span class="p">(</span><span class="nb">require</span> <span class="ss">'popweb-katex</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="使用">使用</h3>
<ul>
  <li>popweb-dict-bing-input: 用Bing来翻译输入单词</li>
  <li>popweb-dict-youdao-input: 用有道来翻译输入单词</li>
  <li>popweb-dict-bing-pointer: 用Bing来翻译光标处单词</li>
  <li>popweb-dict-youdao-pointer: 用有道来翻译光标处单词</li>
</ul>

<h3 id="代理">代理</h3>
<p>代理设置，目前Bing和Youdao还用不上，主要是为国外的其他翻译服务做准备。</p>

<pre><code class="language-Elisp">(setq popweb-proxy-type "http")
(setq popweb-proxy-host "127.0.0.1")
(setq popweb-proxy-port "1080")
</code></pre>

<p>如果你是socks5代理，可以像下面这样更换类型：</p>

<pre><code class="language-Elisp">(setq popweb-proxy-type "socks5")
</code></pre>

<h2 id="截图">截图</h2>
<h3 id="bing翻译">Bing翻译</h3>
<p><img src="//manateelazycat.github.io/pics/popweb/dict-bing.png" alt="Bing" /></p>

<h3 id="有道翻译">有道翻译</h3>
<p><img src="//manateelazycat.github.io/pics/popweb/dict-youdao.png" alt="Youdao" /></p>

<h3 id="latex预览">LaTex预览</h3>
<p><img src="//manateelazycat.github.io/pics/popweb/katex-preview.png" alt="KaText" /></p>

<h2 id="技术优势">技术优势</h2>
<p>popweb是具备EAF的核心的，包括：</p>

<ol>
  <li>支持完整的PyQt和Chromium浏览器渲染引擎</li>
  <li>支持Elisp、Python、JavaScript互调用技术</li>
  <li>支持 node 和 vue.js</li>
</ol>

<p>popweb 和 EAF唯一的不同是， popweb没有处理窗口管理和按键转发，popweb天然支持 Windows, Mac, Linux平台，可以应用于各种 <strong>富文本弹出框</strong> 场景, 比如翻译、LaTex预览、文档提示、代码补全等。</p>

<h2 id="后续">后续</h2>
<p>popweb是一个通用框架，不光可以展示翻译内容，也可以加载任意Web页面，欢迎大家贡献新的想法和插件。</p>

<p>Enjoy!</p>

            </div>
        </div>
    </body>
</html>
