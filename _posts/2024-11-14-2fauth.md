---
layout: post
title: 用自托管的 2FAuth 来做双因素身份验证
categories: [Linux, Microserver]
---

现在的互联网真是麻烦哇， 像 Github/Google/NPM 这些网站都强制要求登录做双因子认证， 之前我一直是用的 Authy 来实现双因子认证的。

最近换了一部三星的手机就遇到很麻烦的事情， Authy 不接受 +86 开头的中国手机号注册了， 这样我的新手机就没法登录 Github， 很郁闷。

今天研究了一下， 发现可以通过自托管的 2FAuth 程序来实现双因子认证， 因为 2FAuth 是托管到自己的服务器上， 再也不会遇到双因子认证程序因中国手机号不能注册， 我自己不能证明我是我的问题。

具体步骤如下：
1. 买一台私有云服务， 我买的是我们家自己生产的 [懒猫微服](https://item.jd.com/10101262547531.html), 它的好处是开箱即用， 不用折腾外网穿透， 并且商店自带了 2FAuth 应用， 不用为了 2FA 还自己折腾 2FAuth 的安装部署
2. 启动微服后， 在应用商店安装 [2FAuth](https://lazycat.cloud/appstore/%2Fshop%2Fdetail%2Fcloud.lazycat.app.c2fauth)
3. 在懒猫微服启动器点击 2FAuth 图标启动
4. 打开 2FAuth 应用， 首先先注册一个账号， 填上自己的邮箱和密码即可注册
5. 然后再点击登录， 直到下一步提示要上传二维码图片的这个步骤， 先停一下等待下一步操作
6. 打开浏览器， 登录 GitHub, 在右上角头像菜单点击 `Settings`, 然后选择 `Password and authentication`, 找到 `Authentication app`, 点击右边的 `Edit` 按钮， 输入 Github 密码进入编辑页面， 编辑页面会生成一个二维码， 保存二维码到电脑
7. 切换到 2FAuth 窗口， 上传二维码图片， 点击 `导入`， 稍微等几秒， 2FAuth 会生成一个 6 位数密码， 把这个 6 位数密码输入第 6 步, Github Authentication 编辑页面里的 `Verbify code` 输入框中， 点击 `Save` 按钮即可

至此， Github 的 2FA 认证已经全部设置好了， 以后再登录 Github 需要输入 2FA 密码的时候， 只用在懒猫微服中启动 2FAuth, 点击 `Github` 就可以查看了。

用自托管 2FAuth 认证的方便之处在于， 生成 2FA 密码的设备不载必须是手机才行 （因为登录的时候手机没电或者手机丢了就没法登录）。  任何可以访问 2FAuth 服务的设备都可以， 得益于懒猫微服的全终端访问能力， 不管是电脑、 手机还是平板， 甚至是你的电动汽车， 你都可以随时随地方便地获取 2FA 密码。

好了， 这就是今天的分享， 希望可以帮助到那些就想好好写代码， 但是因为地缘政治这种荒谬原因没法获取 2FA 密码的同学们。