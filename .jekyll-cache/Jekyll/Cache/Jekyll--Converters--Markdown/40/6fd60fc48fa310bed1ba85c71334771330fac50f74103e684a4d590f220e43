I"¢<h3 id="è¢«webpackå¼„çš„å¤´å¤§">è¢«Webpackå¼„çš„å¤´å¤§</h3>
<p>è¿™å‡ å¤©åœ¨å‡†å¤‡å¼€å‘ä¸€ä¸ªåŸºäº React/Redux çš„åº”ç”¨, NodeJS å’Œ React ä¸€å¤©ä¹‹å†…å°±å­¦å®Œäº†, ä½†æ˜¯å­¦ä¹  Webpack çš„æ—¶å€™å´èŠ±äº†ä¸¤å¤©çš„æ—¶é—´æŠ˜è…¾, ä¸»è¦åŸå› æœ‰ä¸¤ä¸ª:</p>
<ul>
  <li>Webpackéå¸¸å¼ºå¤§, é…ç½®æ–‡ä»¶å’Œæ’ä»¶ç”Ÿæ€éƒ½éå¸¸ä¸°å¯Œ, ä½†æ˜¯å½“å¯ä»¥é€‰æ‹©çš„é…ç½®å’Œæ’ä»¶å¤ªå¤šä»¥å, ä¸€å¼€å§‹ä¸çŸ¥é“æ€ä¹ˆä¸‹æ‰‹</li>
  <li>æ€ä¹ˆç”¨ Webpack æŠŠä¸¤ç§ä¸åŒçš„æ¡†æ¶ç²˜åˆåœ¨ä¸€èµ·? æ¯”å¦‚ React å’Œ Express, ä¸€ä¸ªæ˜¯å‰ç«¯æ¡†æ¶, ä¸€ä¸ªæ˜¯åç«¯æ¡†æ¶, æ€ä¹ˆç²˜åˆåœ¨ä¸€èµ·, å®˜ç½‘çš„ç¤ºä¾‹æ–‡æ¡£çœ‹å®Œåªèƒ½äº†è§£ Webpack é…ç½®æ–‡ä»¶çš„åŸºæœ¬ç»“æ„, ä½†æ˜¯æ€ä¹ˆç²˜åˆå¤æ‚è¿˜éœ€è¦è‡ªå·±æŠ˜è…¾</li>
</ul>

<h3 id="å­¦ä¹ æ–¹æ³•">å­¦ä¹ æ–¹æ³•</h3>
<p>å¥½åœ¨ç»è¿‡ä¸¤å¤©Google, çœ‹äº†ä¸€ç™¾å¤šä¸ªå›½å¤–çš„æŠ€æœ¯åšå®¢, ç®—æ˜¯æŠŠWebpackå…¥é—¨äº†, çŸ¥é“æ€ä¹ˆç”¨Webpackæ­å»º React + Express å¼€å‘ç¯å¢ƒäº†.</p>

<p>åœ¨åˆ†äº«æ­å»ºç¯å¢ƒæ­¥éª¤ä¹‹å‰, æˆ‘æƒ³åˆ†äº«ä¸€ä¸‹æˆ‘æ˜¯æ€ä¹ˆå¿«é€Ÿå­¦ä¹ çš„æ–¹æ³•, ç‰¹åˆ«æ˜¯é’ˆå¯¹è¿™ç§å¤šç»´åº¦ã€é«˜å¤æ‚åº¦å’Œç›¸äº’äº¤å‰çš„ç»¼åˆçŸ¥è¯†é¢†åŸŸ, å› ä¸ºå¾ˆå¤šåŒå­¦é™¤äº†å–œæ¬¢æˆ‘çš„æŠ€æœ¯æ–‡ç« å¤–, æ›´åŠ å…³å¿ƒæˆ‘å¿«é€Ÿå­¦ä¹ çš„æ–¹æ³•.</p>

<p>1 <strong>è¦å¯¹è‡ªå·±æœ‰è¶³å¤Ÿçš„ä¿¡å¿ƒ</strong>, å³ä½¿ä¸€å¼€å§‹ä½ è¿˜æ˜¯ä¸€è„¸æ‡µé€¼çš„çŠ¶æ€, ä¸çŸ¥é“å¦‚ä½•ä¸‹æ‰‹, ä¹Ÿè¦å¯¹è‡ªå·±æœ‰ç»å¯¹çš„è‡ªä¿¡, å› ä¸ºæœ‰æ—¶å€™æˆ‘ä»¬æ²¡æ³•ç²¾é€šä¸€é—¨æŠ€æœ¯, ä¸æ˜¯å› ä¸ºæˆ‘ä»¬ç¬¨, è€Œæ˜¯ä¸€å¼€å§‹æˆ‘ä»¬çš„ä¿¡å¿ƒä¸è¶³, è¢«å›°éš¾å“åˆ°äº†è€Œä¸æ•¢å°è¯•. æ‰€ä»¥åœ¨ä¸€å¼€å§‹çœ‹åˆ° Webpack ä¸€å›¢ä¹±éº»çš„æƒ…å†µä¸‹, æˆ‘çš„ä¿¡å¿ƒæ¥æºäº: â€œEmacsè¿™ä¸ªä¸–ç•Œä¸Šæœ€å¤æ‚ã€æœ€éš¾æŠ˜è…¾çš„è½¯ä»¶æˆ‘éƒ½å¯ä»¥ç©çš„å¾ˆæºœ, è¿˜æœ‰ä»€ä¹ˆä¸œè¥¿æ˜¯æˆ‘æ²¡æ³•æå®šçš„? â€œ æ‰€ä»¥, ä¿æŒäº†è¿™ç§å¼ºå¤§çš„ä¿¡å¿ƒ, ç»è¿‡ä¸¤å¤©çš„ç¼ æ–—æœ€ç»ˆè¿˜æ˜¯å½»åº•ç†è§£äº† Webpack</p>

<p>2 <strong>è‡ªå·±æƒ³è¦è§£å†³çš„é—®é¢˜æ˜¯ä»€ä¹ˆ</strong>, åªæœ‰éå¸¸æ¸…æ™°çš„çŸ¥é“è‡ªå·±æƒ³è¦è§£å†³çš„é—®é¢˜, è¿™æ ·åœ¨æœç´¢å’Œå­¦ä¹ çš„æ—¶å€™, æ‰ä¸ä¼šè¢«å¾ˆå¤šä¸å…³å¿ƒçš„ä¿¡æ¯æ‰€å¹²æ‰°, æ¯”å¦‚è¿™ä¸¤å¤©, æˆ‘ä¸€ç›´åœ¨Googleä¸Šæœç´¢ â€œReact Express Webpackâ€ ç›¸å…³çš„æ–‡ç« , è¿™è¿‡ç¨‹ä¸­, çœ‹åˆ°äº†å¾ˆå¤šå…³äº Vue.js, Gulp ç­‰ç­‰ä¸ç›¸å…³çš„æ–‡ç« , è™½ç„¶ä¹Ÿå†™çš„å¾ˆå¥½, ä½†æ˜¯é€šé€šè¢«æˆ‘æ— æƒ… pass äº†, æˆ‘ä¸€ç›´ç›¯ç€æˆ‘çš„ç›®æ ‡åœ¨çœ‹ææ–™. æ‰€ä»¥, æ¸…æ™°çš„ç›®æ ‡èƒ½å¤Ÿå¸®åŠ©ä½ é¿å…è¿‡åº¦æ— ç”¨ä¿¡æ¯çš„å¹²æ‰°.</p>

<p>3 <strong>é€šè¿‡çœ‹å¤§é‡çŸ¥è¯†ç¼©å°æ€è€ƒèŒƒå›´</strong>, åœ¨ç›®æ ‡æ˜ç¡®çš„å‰æä¸‹, å…ˆçœ‹å¤§é‡çš„æŠ€æœ¯åšå®¢å’Œæ–‡ç« , æ¯ä¸ªæŠ€æœ¯æ–‡ç« éƒ½ä¼šæä¾›è§£å†³æŸä¸€ä¸ªå°é—®é¢˜çš„çŸ¥è¯†, æ¯”å¦‚, æœ‰äº›æ–‡ç« å¯¹æ­å»ºç¯å¢ƒçš„ç›®å½•ç»“æ„å†™çš„å¾ˆå¥½, æœ‰äº›æ–‡ç« è®²è§£ webpack é…ç½®å¾ˆè¯¦ç»†, æœ‰äº›æ–‡ç« è®²çƒ­æ›¿æ¢è®²çš„å¾ˆå¥½. ä½ éœ€è¦çœ‹è¶³å¤Ÿå¤šçš„æ–‡ç« , é€šè¿‡å¯¹æ¯”, æ‰èƒ½çŸ¥é“å“ªç¯‡æ–‡ç« æ˜¯æœ€æ–°çš„, è€Œä¸”æ˜¯å†™çš„æœ€æ¸…æ™°çš„, å“ªç¯‡æ–‡ç« å†™çš„ä¸œè¥¿æ˜¯å·²ç»é™ˆæ—§æ²¡ç”¨çš„. æˆ‘è¿™ä¸¤å¤©çœ‹äº†100å¤šç¯‡æŠ€æœ¯æ–‡ç« , æœ€åé€šè¿‡å¯¹æ¯”å’Œå®éªŒ, å‘ç°æœ€ååªæœ‰å‡ ç¯‡æ–‡ç« ä¸­çš„å†…å®¹æ‰æ˜¯æœ€æ–°çš„, å¹¶ç¬¦åˆæˆ‘è¦æ±‚çš„ç´ æ. å¤§é‡çœ‹æŠ€æœ¯æ–‡ç« æ‰èƒ½å­¦åˆ°è¶³å¤Ÿçš„çŸ¥è¯†å»è§£å†³é—®é¢˜, å¦‚æœä½ çœ‹çš„æ–‡ç« å’ŒçŸ¥è¯†é‡ä¸å¤Ÿ, å³ä½¿æœ€åä½ ä¸œå¹³è¥¿å‡‘ç¢°å·§æˆåŠŸäº†, å°†æ¥é‡åˆ°é—®é¢˜åè¿˜æ˜¯ä¸æ¸…æ¥šè§£å†³é—®é¢˜çš„æ ¹æº, æœ€åä¼šèŠ±è´¹æ›´å¤šæ—¶é—´å»äº¤å­¦è´¹.</p>

<p>4 <strong>ä¾è‘«èŠ¦ç”»ç“¢æ‰ä¼šèæ±‡è´¯é€š</strong>, ä¸€èˆ¬å¤æ‚çš„çŸ¥è¯†éƒ½æ˜¯æ²¡æœ‰ç°æˆè§£å†³æ–¹æ¡ˆçš„, ä½ åªèƒ½é€šè¿‡å¤šç§çŸ¥è¯†ç»„åˆæ‰èƒ½è§£å†³é—®é¢˜, è€Œæ€ä¹ˆç»„åˆçš„å…³é”®å°±æ˜¯è¦å…ˆä¾è‘«èŠ¦ç”»ç“¢æŠŠä»£ç å’Œé…ç½®æ­¥éª¤éƒ½ <strong>æ‰‹å·¥</strong> æ•²ä¸€é, æ‰‹å·¥æ•²çš„ç›®çš„æ˜¯ä¸ºäº†è®©æ‰‹äº§ç”Ÿè¶³å¤Ÿå¼ºåº¦å’Œæ‰‹æŒ‡è®°å¿†, è¿™æ ·ä½ åœ¨æ‰‹å·¥æ•²æ‰“çš„åŒæ—¶ä¼šåœ¨è„‘è¢‹é‡Œåå¤çš„æ€è€ƒæ¯ä¸€ä¸ªæ­¥éª¤åé¢çš„æ„ä¹‰, è¿™ç§çœ‹ä¼¼ç¬¨çš„æ–¹æ³•, ä¼šæœ€å¤§å¼ºåº¦çš„å¢å¼ºä½ å¯¹æ‰€å­¦çŸ¥è¯†çš„å°è±¡, è¿™äº›çŸ¥è¯†ä¼šåœ¨æ½œæ„è¯†é‡Œé¢æ²‰æ·€ç€, å½“ä½ é‡åˆ°ä¸¤ç§ä¸åŒçš„çŸ¥è¯†éœ€è¦èåˆçš„æ—¶å€™, è¿™äº›æ½œæ„è¯†çš„çŸ¥è¯†å°±ä¼šè¹¦å‡ºæ¥å¸®ä½ äº§ç”Ÿéå¸¸é‡è¦çš„è”ç³»å’Œçº¿ç´¢, å½“æ‰€æœ‰çŸ¥è¯†ç‚¹æœ€åéƒ½è¿æˆä¸€å¼ æ¸…æ™°çš„é€»è¾‘ç½‘ä»¥å, é—®é¢˜è‡ªç„¶å°±è§£å†³äº†.</p>

<p>5 <strong>æŠŠè§£å†³æ–¹æ¡ˆå†™ä¸‹æ¥</strong>, åŸæ¥åœ¨æ·±åº¦çš„æ—¶å€™, æ¯ä¸ªæœˆéƒ½ä¼šç»™å›¢é˜ŸåŸ¹è®­, å…¶å®è‡ªå·±å­¦çš„çŸ¥è¯†å…¶å®å·²ç»éå¸¸ç†Ÿç»ƒå’Œç‰¢å›ºäº†, ä½†å½“æˆ‘æŠŠè¿™äº›çŸ¥è¯†é€šè¿‡ PPT æˆ–è€…æŠ€æœ¯æ–‡ç« çš„å½¢å¼å†™å‡ºæ¥çš„æ—¶å€™, æˆ‘ä¼šéå¸¸æ³¨æ„æ–‡ç« çš„ç®€æ´æ€§å’Œæ¸…æ™°åº¦, ä»¥æ–¹ä¾¿åˆ«äººèƒ½å¤Ÿæœ€å°è´Ÿæ‹…çš„çœ‹æ‡‚. æœ€å, æˆ‘å‘ç°, å½“ä½ æ•™åˆ«äººçš„æ—¶å€™, è‡ªå·±çš„çŸ¥è¯†ä½“ç³»ä¹Ÿä¼šå˜å¾—æ›´æ·±æ›´å¹¿, æ€è·¯ä¹Ÿä¼šæ›´åŠ æ¸…æ™°.</p>

<h3 id="é…ç½®-react--express-å¼€å‘ç¯å¢ƒ">é…ç½® React + Express å¼€å‘ç¯å¢ƒ</h3>
<h4 id="å¸¦ç€ç›®çš„æ€§å»å­¦ä¹ ">å¸¦ç€ç›®çš„æ€§å»å­¦ä¹ </h4>
<p><img src="http://localhost:4000/pics/webpack-and-react/webpack-and-react.png" alt="å®Œæ•´çš„å·¥ä½œæµç¨‹" /></p>

<p>åœ¨æŠ˜è…¾ä¹‹å‰, å…ˆæŠŠä¸Šé¢çš„è¿™å¼ é€»è¾‘æµç¨‹æƒ³æ¸…æ¥š, è¿™å°±æ˜¯æˆ‘ä»¬å¼€å‘ç¯å¢ƒéœ€è¦è¾¾åˆ°çš„æœ€åç›®æ ‡, è®°ä½è¿™ä¸ªå¼€å‘æµç¨‹, ä½ åœ¨é˜…è¯»é‚£äº›é…ç½®æ–‡ä»¶ç»†èŠ‚çš„æ—¶å€™, å°±ä¼šç†è§£çš„æ›´æ·±å…¥:</p>
<ul>
  <li>æˆ‘ä»¬ä¿®æ”¹å‰ç«¯èµ„æºæ–‡ä»¶ (js css image) æ—¶, Webpack ä¼šå®æ—¶çš„é‡æ–°ç¼–è¯‘æ‰“åŒ…, æ‰“åŒ…å®Œæˆåé€šè¿‡çƒ­æ›¿æ¢ (HMR) å®æ—¶æ›¿æ¢æµè§ˆå™¨ä¸­çš„èµ„æºæ–‡ä»¶, åœ¨æ— åˆ·æ–°é¡µé¢çš„å‰æä¸‹, å®æ—¶çš„åœ¨æµè§ˆå™¨çœ‹JS/CSSå˜åŠ¨åçš„UIæ•ˆæœ, çƒ­æ›¿æ¢çš„å¥½å¤„å°±æ˜¯ä»£ç é€»è¾‘å’Œæ ·å¼æ•ˆæœæ›´æ¢çš„å‰æä¸‹, å½“å‰é¡µé¢çš„çŠ¶æ€æ˜¯ä¸å˜çš„, ä½ ä¸ç”¨åƒåˆ·æ–°é¡µé¢é‚£æ ·, è¦é‡æ–°ç‚¹ä¸€éå‰ç«¯é¡µé¢æ‰èƒ½çœ‹åˆ°æŸäº›æ•ˆæœ(æ¯”å¦‚èœå•).</li>
  <li>æˆ‘ä»¬ä¿®æ”¹åç«¯ä»£ç ã€é…ç½®æˆ–åç«¯é¡µé¢æ—¶, Nodemon ä¼šç«‹å³é‡å¯æœåŠ¡å™¨, å¹¶åœ¨é‡å¯å®Œæˆå, é€šçŸ¥æµè§ˆå™¨åˆ·æ–°é¡µé¢, è¾¾åˆ°è‡ªåŠ¨åˆ·æ–°å‰ç«¯é¡µé¢çš„æ•ˆæœ.</li>
  <li>ä¸è®ºæ˜¯å‰ç«¯è¿˜æ˜¯åç«¯ä»£ç æ›´æ–°å, éƒ½ä¼šè§¦å‘æµè§ˆå™¨é¡µé¢æ›´æ–°, æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­æ£€æŸ¥æ•ˆæœå, ç»§ç»­ä¿®æ”¹ä»£ç , ä»¥å®Œæˆä¸€ä¸ªå·¥ä½œæµå‘¨æœŸ.</li>
</ul>

<p>å…¶å® Webpack æœ¬è´¨ä¸Šå°±æ˜¯é€šè¿‡å„ç§æ’ä»¶æ¥å®Œæˆè¿™ä¸ªå·¥ä½œæµ, åªä¸è¿‡éšç€ä½ ç»éªŒè¶Šæ¥è¶Šä¸°å¯Œ, ä½ ä¼šç”¨æ›´å¤šçš„æ’ä»¶å»ç²˜åˆå‰åç«¯æ¡†æ¶å’Œå„ç§å·¥å…·æ¨¡å—, ä»¥å®Œæˆæ›´åŠ æ™ºèƒ½çš„è‡ªåŠ¨åŒ–æµç¨‹.</p>

<p>æ²¡çœ‹æ‡‚? æ²¡å…³ç³», è·Ÿç€æˆ‘é…ç½®ä¸€éå§, é…ç½®å®Œä»¥å, ä½ å°±æ‡‚äº†.</p>

<h4 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h4>
<p><strong>å®‰è£… homebrew</strong></p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/bin/ruby <span class="nt">-e</span> <span class="s2">"</span><span class="k">$(</span>curl <span class="nt">-fsSL</span> https://raw.githubusercontent.com/Homebrew/install/master/install<span class="k">)</span><span class="s2">"</span>
</code></pre></div></div>

<p><strong>å®‰è£… nodejs</strong></p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install </span>node
</code></pre></div></div>

<p><strong>å®‰è£…cnpm</strong>
npm æ¯æ¬¡å»å›½å¤–æœåŠ¡å™¨ä¸‹è½½ä¸œè¥¿éƒ½å¾ˆæ…¢, æµªè´¹äº†å¾ˆå¤šæ—¶é—´, æ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆå®‰è£…ä¸€ä¸‹ cnpm æ¥åŠ é€Ÿ npm åŒ…çš„ä¸‹è½½:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> <span class="nt">-g</span> cnpm <span class="nt">--registry</span><span class="o">=</span>http://r.cnpmjs.org
</code></pre></div></div>

<p><strong>æ–°å»ºé¡¹ç›®</strong></p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>project <span class="o">&amp;&amp;</span> <span class="nb">cd </span>project <span class="o">&amp;&amp;</span> npm init <span class="nt">-y</span>
</code></pre></div></div>
<p>è¿™ä¸ªå‘½ä»¤ä¼šåœ¨å½“å‰æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ª package.json æ–‡ä»¶, package.json çš„ä½œç”¨ä¸»è¦æ˜¯è®°å½•å¼€å‘è¿‡ç¨‹ä¸­éƒ½å®‰è£…äº†å“ªäº›åŒ…åŠåŒ…çš„ç‰ˆæœ¬, æ–¹ä¾¿ç”¨ git ç®¡ç†å’Œä»¥åç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ç”¨.</p>

<p><strong>å®‰è£…ä¾èµ–åŒ…</strong>
ä¸‹é¢æ˜¯ npm/cnpm å‘½ä»¤å¸¸ç”¨çš„ä¸‰ä¸ªå®‰è£…å‘½ä»¤çš„åŒºåˆ«:</p>

<table>
  <thead>
    <tr>
      <th>cnpm å‘½ä»¤</th>
      <th>å‚æ•°è¯´æ˜</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cnpm install package -g</td>
      <td>å®‰è£…åˆ°ç³»ç»Ÿä¸­, ä»»ä½•é¡¹ç›®éƒ½å¯ä»¥ä½¿ç”¨</td>
    </tr>
    <tr>
      <td>cnpm install package â€“save</td>
      <td>å®‰è£…åˆ°é¡¹ç›®æœ¬åœ°ç›®å½•ä¸­, å¹¶ä¿å­˜åŒ…åä¿¡æ¯åˆ°ä¾èµ–å­—æ®µ dependencies ä¸‹, ä¸‹æ¬¡éƒ¨ç½²æœåŠ¡å™¨å°±å¯ä»¥é€šè¿‡ package.json æ–‡ä»¶è‡ªåŠ¨å®‰è£…ä¾èµ–åŒ…</td>
    </tr>
    <tr>
      <td>cnpm install package â€“save-dev</td>
      <td>å’Œ â€“save å‚æ•°ç±»ä¼¼, åªä¸è¿‡ä¿å­˜åŒ…ä¿¡æ¯åˆ°ä¾èµ–å­—æ®µ devDependencies ä¸‹, è¡¨ç¤ºåªåœ¨å¼€å‘ç¯å¢ƒæ‰ä¼šå®‰è£…, ç”Ÿäº§ç¯å¢ƒä¸ä¼šå®‰è£…çš„åŒ…</td>
    </tr>
  </tbody>
</table>

<p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å¯ä»¥è‡ªåŠ¨å®‰è£…æ‰€æœ‰ä¾èµ–åŒ…:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cnpm <span class="nb">install</span> <span class="nt">--save</span> react react-dom react-hot-loader

cnpm <span class="nb">install</span> <span class="nt">--save</span> express body-parser cookie-parser multer

cnpm <span class="nb">install</span> <span class="nt">--save-dev</span> webpack webpack-dev-server webpack-cli webpack-dev-middleware webpack-hot-middleware

cnpm <span class="nb">install</span> <span class="nt">--save-dev</span> @babel/core @babel/preset-env @babel/preset-react babel-loader

cnpm <span class="nb">install</span> <span class="nt">--save-dev</span> less less-loader css-loader style-loader

cnpm <span class="nb">install</span> <span class="nt">--save-dev</span> reload nodemon
</code></pre></div></div>
<p>ä¸‹é¢æ˜¯æ¯æ¡å‘½ä»¤å’Œå®‰è£…åŒ…çš„ä½œç”¨è¯´æ˜:
| ä¾èµ–åŒ… | ä½œç”¨è¯´æ˜|
| â€”â€”â€” | â€”â€”â€”â€”|
| react react-dom react-hot-loader | React å‰ç«¯æ¡†æ¶ç›¸å…³çš„åº“å’Œçƒ­æ›¿æ¢æ’ä»¶ |
| express body-parser cookie-parser multer | åŸºäº NodeJS çš„åç«¯æ¡†æ¶ Express å’Œå®ƒçš„ä¾èµ–åº“ |
| webpack webpack-dev-server webpack-cli webpack-dev-middleware webpack-hot-middleware | Webpack å’Œçƒ­æ›¿æ¢ä¸­é—´ä»¶ |
| @babel/core @babel/preset-env @babel/preset-react babel-loader | Babel æ’ä»¶, ä¸»è¦ç”¨äºè½¬æ¢ React çš„ ES6 è¯­æ³•åˆ°æµè§ˆå™¨å¯ä»¥è¯†åˆ«çš„æ­£å¸¸ JS è¯­æ³• |
| less less-loader css-loader style-loader | Less è¯­æ³•ç¼–å†™çš„æ ·å¼æ–‡ä»¶ä¼šè‡ªåŠ¨ç¼–è¯‘æˆ CSS æ ¼å¼çš„ |
| reload nodemon | é¡µé¢ä¸»åŠ¨åˆ·æ–°æ’ä»¶å’ŒæœåŠ¡å™¨é‡å¯å·¥å…· |</p>

<h4 id="ç›®å½•ç»“æ„">ç›®å½•ç»“æ„</h4>
<p>åœ¨æŠ˜è…¾é…ç½®æ–‡ä»¶ä¹‹å‰, æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸‹æœ€ç»ˆçš„ç›®å½•ç»“æ„:</p>

<p>project</p>

<p>â”œâ”€â”€ app.js</p>

<p>â”œâ”€â”€ client</p>

<p>â”‚Â Â        â”œâ”€â”€ index.less</p>

<p>â”‚Â Â        â””â”€â”€ index.js</p>

<p>â”œâ”€â”€ server</p>

<p>â”‚Â Â          â””â”€â”€ index.html</p>

<p>â”œâ”€â”€ dist</p>

<p>â”‚Â Â          â””â”€â”€ bundle.js</p>

<p>â”œâ”€â”€ .babelrc</p>

<p>â”œâ”€â”€ nodemon.json</p>

<p>â”œâ”€â”€ package.json</p>

<p>â””â”€â”€ webpack.config.js</p>

<table>
  <thead>
    <tr>
      <th>æ–‡ä»¶</th>
      <th>æ–‡ä»¶è¯´æ˜</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>app.js</td>
      <td>å¯åŠ¨å…¥å£, åç«¯ express ä»£ç , æ§åˆ¶è·¯ç”±å’ŒHTTPè¯·æ±‚å“åº”</td>
    </tr>
    <tr>
      <td>client</td>
      <td>React å‰ç«¯ç»„ä»¶ä»£ç , åŒ…æ‹¬ JS å’Œ CSS æ–‡ä»¶</td>
    </tr>
    <tr>
      <td>server</td>
      <td>åç«¯è§†å›¾æ–‡ä»¶, ä¸»è¦æ˜¯ html æ–‡ä»¶</td>
    </tr>
    <tr>
      <td>dist</td>
      <td>Webpack ç¼–è¯‘æ‰“åŒ…æ–‡ä»¶å­˜æ”¾çš„ç›®å½•</td>
    </tr>
    <tr>
      <td>.babelrc</td>
      <td>Babel çš„é…ç½®æ–‡ä»¶</td>
    </tr>
    <tr>
      <td>nodemon.json</td>
      <td>nodemon çš„é…ç½®æ–‡ä»¶</td>
    </tr>
    <tr>
      <td>package.json</td>
      <td>é¡¹ç›®é…ç½®æ–‡ä»¶, ä¸»è¦å­˜æ”¾åŒ…ä¿¡æ¯å’ŒæœåŠ¡ç«¯å¯åŠ¨å‘½ä»¤</td>
    </tr>
    <tr>
      <td>webpack.config.js</td>
      <td>Webpack é…ç½®æ–‡ä»¶</td>
    </tr>
  </tbody>
</table>

<h4 id="æŠ˜è…¾é…ç½®æ–‡ä»¶">æŠ˜è…¾é…ç½®æ–‡ä»¶</h4>
<p>æˆ‘ä»¬æŒ‰ç…§ä¸Šé¢çš„ç›®å½•ç»“æ„å»å¡«å……æ¯ä¸ªé…ç½®æ–‡ä»¶, æˆ‘ä¼šåœ¨æ–‡ä»¶ä¸‹é¢è®²è§£æ¯è¡Œä»£ç çš„æ„æ€:</p>

<p><strong>app.js</strong></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">),</span>
    <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">(),</span>
    <span class="nx">reload</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'reload'</span><span class="p">),</span>
    <span class="nx">rootPath</span> <span class="o">=</span> <span class="nx">__dirname</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">webpack</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"webpack"</span><span class="p">),</span>
    <span class="nx">webpackConfig</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"./webpack.config"</span><span class="p">),</span>
    <span class="nx">webpackDevMiddleware</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"webpack-dev-middleware"</span><span class="p">),</span>
    <span class="nx">webpackHotMiddleware</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"webpack-hot-middleware"</span><span class="p">),</span>
    <span class="nx">compiler</span> <span class="o">=</span> <span class="nx">webpack</span><span class="p">(</span><span class="nx">webpackConfig</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
  <span class="nx">webpackDevMiddleware</span><span class="p">(</span><span class="nx">compiler</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">publicPath</span><span class="p">:</span> <span class="nx">webpackConfig</span><span class="p">.</span><span class="nx">output</span><span class="p">.</span><span class="nx">publicPath</span><span class="p">,</span>
    <span class="na">noInfo</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">stats</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">colors</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">})</span>
<span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">webpackHotMiddleware</span><span class="p">(</span><span class="nx">compiler</span><span class="p">));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">'/dist'</span><span class="p">));</span>

<span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">sendFile</span><span class="p">(</span><span class="nx">rootPath</span> <span class="o">+</span> <span class="s1">'/server/index.html'</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">reload</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'* Server starting...'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<ul>
  <li>
    <p>é¡¶éƒ¨æ˜¯ä¾èµ– import ç›¸å…³çš„ä»£ç </p>
  </li>
  <li>
    <p>ä¸­é—´ app.use çš„ä»£ç çš„æ„æ€æ˜¯åŠ å…¥ Webpack çƒ­æ›¿æ¢æ’ä»¶, ä¸€æ—¦ Webpack æ ¹æ® webpack.config.js çš„ entry é…ç½®å‘ç°ä½ ä¿®æ”¹äº†ç›¸å…³çš„ JS/LESS æ–‡ä»¶, webpack ä¼šè‡ªåŠ¨é‡æ–°ç¼–è¯‘ã€æ‰“åŒ…å’Œçƒ­æ›¿æ¢æµè§ˆå™¨çš„ dist/bunlde.js ä»£ç , è€Œæ— éœ€é‡å¯æœåŠ¡å™¨å’Œæ‰‹åŠ¨åˆ·æ–°, æ³¨æ„è¿™æ®µä»£ç éœ€è¦æ”¾åœ¨è·¯ç”±ä»£ç  app.get ä¹‹å‰æ‰èƒ½ç”Ÿæ•ˆ</p>
  </li>
  <li>
    <p>app.get çš„ä»£ç å°±æ˜¯ express è·¯ç”±ä»£ç , è®¿é—® http://localhost:3000 çš„æ—¶å€™, æŠŠ ./server/index.html çš„æ–‡ä»¶è¿”å›ç»™æµè§ˆå™¨å»æ¸²æŸ“</p>
  </li>
  <li>
    <p>reload(app) ä»£ç çš„ä½œç”¨æ˜¯, ä¸€æ—¦ä½ ä¿®æ”¹åç«¯ä»£ç æˆ–è€… HTML æ–‡ä»¶, ä¼šå¼•å‘ nodejs/express æœåŠ¡å™¨é‡å¯, é‡å¯å, reload æ’ä»¶ä¼šè‡ªåŠ¨é€šè¿‡WebSocketå»é‡æ–°åŠ è½½æµè§ˆå™¨é¡µé¢, ä¸éœ€è¦æ‰‹åŠ¨åˆ·æ–°</p>
  </li>
  <li>
    <p>app.listen ä»£ç çš„ä½œç”¨å°±æ˜¯ç›‘å¬æœ¬åœ° 3000 ç«¯å£, æ‰“å¼€ http://localhost:3000 å³å¯æœ¬åœ°å¼€å‘äº†</p>
  </li>
</ul>

<p><strong>client/index.js</strong></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="s1">'react-dom'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">styles</span> <span class="k">from</span> <span class="s2">"./index.less"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">title</span> <span class="o">=</span> <span class="s1">'React + Express rocks!'</span><span class="p">;</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="p">{</span> <span class="nx">styles</span><span class="p">.</span><span class="nx">title</span> <span class="p">}</span> <span class="o">&gt;</span><span class="p">{</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/div&gt;</span><span class="err">,
</span>    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'app'</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">module</span><span class="p">.</span><span class="nx">hot</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">module</span><span class="p">.</span><span class="nx">hot</span><span class="p">.</span><span class="nx">accept</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>
    <p>é¡¶éƒ¨æ˜¯ import ä»£ç , å¯¼å…¥ React åº“å’Œ LESS ç»„ä»¶</p>
  </li>
  <li>
    <p>ä¸­é—´ ReactDOM.render å°±æ˜¯ React ç»„ä»¶çš„ä»£ç , æ›¿æ¢ server/index.html ä¸­ id ä¸º app çš„ DIV åŒºåŸŸ, React ç»„ä»¶çš„æ ·å¼ä¸»è¦é€šè¿‡ <code class="highlighter-rouge">import styles from "./index.less"</code> æ¥å¼•å…¥, è¿™æ ·æ¯ä¸ªç»„ä»¶çš„æ ·å¼éƒ½å•ç‹¬æ”¾åœ¨ç»„ä»¶ç›¸å…³çš„ less æ–‡ä»¶ä¸­, ä¸ä¼šå› ä¸ºç»„ä»¶è¶Šæ¥è¶Šå¤š, less çš„ä½œç”¨åŸŸç›¸äº’å½±å“</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">module.hot.accpet()</code> ä»£ç çš„æ„æ€å°±æ˜¯å½“JSä¿®æ”¹å, å¦‚æœå½“å‰æ¨¡å—æ˜¯çƒ­çš„å³è¿›è¡Œçƒ­æ›¿æ¢, å’Œ app.js ä¸­çš„  <code class="highlighter-rouge">app.use(webpackHotMiddleware(compiler))</code> ä»£ç å¯¹åº”, åªæœ‰è¿™ä¸¤ä¸ªä»£ç éƒ½å­˜åœ¨, JS/LESSæ–‡ä»¶ä¿®æ”¹åæ‰ä¼šè¿›è¡Œçƒ­æ›¿æ¢æ“ä½œ</p>
  </li>
</ul>

<p>client/index.js è¿™ä¸ªæ–‡ä»¶ä¸»è¦æ˜¯å¼€å‘ç”¨çš„æ–‡ä»¶, ä¿®æ”¹åä¼šè‡ªåŠ¨è¢« webpack æ·»åŠ JSä¾èµ–åæ±‡æ€»ç¼–è¯‘æˆ dist/bundle.js æ–‡ä»¶, æ‰€ä»¥ server/index.html çš„JSè„šæœ¬ä¸æ˜¯ index.js , è€Œåº”è¯¥æ˜¯ bundle.js</p>

<p><strong>client/index.less</strong></p>
<pre><code class="language-CSS">.title {
    color: red;
    margin: 20px;
}
</code></pre>

<p>æœ€ç®€å•çš„LESSæ–‡ä»¶, éœ€è¦å®‰è£… lessã€less-loaderã€ style-loader å’Œ css-loader è¿™å››ä¸ªæ’ä»¶, æ‰èƒ½é€šè¿‡ webpack ä¿è¯ JS/JSX æ–‡ä»¶ä¸­å¯ä»¥ç›´æ¥æ‰§è¡Œ <code class="highlighter-rouge">import styles from "./index.less"</code> æ¥ä½¿ç”¨ LESS æ–‡ä»¶çš„æ ·å¼å†…å®¹.</p>

<p><strong>server/index.html</strong></p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span>Cool<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;h1&gt;</span>Hello World<span class="nt">&lt;/h1&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"app"</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"./bundle.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"/reload/reload.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>
<p>éå¸¸ç®€å•çš„ HTML æ–‡ä»¶</p>
<ul>
  <li><code class="highlighter-rouge">&lt;div id="app"&gt;&lt;div&gt;</code> ä¸€ä¸ªDIVå ä½ç¬¦, ç”¨äº React çš„JSç»„ä»¶è¿›è¡ŒDOMæ›¿æ¢æ“ä½œ</li>
  <li><code class="highlighter-rouge">&lt;script src="./bundle.js"&gt;&lt;/script&gt;</code> æ³¨æ„, è¿™é‡ŒåŠ è½½çš„æ˜¯ Webpack ç¼–è¯‘åçš„ bundle.js æ–‡ä»¶, è€Œä¸æ˜¯ client/index.js æ–‡ä»¶</li>
  <li><code class="highlighter-rouge">&lt;script src="/reload/reload.js"&gt;&lt;/script&gt;</code> è¿™é‡Œçš„ reload.js å°±å¯¹åº” app.js ä¸­çš„ <code class="highlighter-rouge">reload(app)</code> ä»£ç , reload æ’ä»¶åœ¨æœåŠ¡å™¨é‡å¯å, ä¼šè‡ªåŠ¨é‡æ–°åŠ è½½æ‰€æœ‰åŒ…æ‹¬ <code class="highlighter-rouge">&lt;script src="/reload/reload.js"&gt;&lt;/script&gt;</code> çš„é¡µé¢</li>
</ul>

<p><strong>dist/bundle.js</strong>
Webpack ä¸ºäº†åŠ å¿«ç¼–è¯‘é€Ÿåº¦, bundle.js æ–‡ä»¶å…¶å®éƒ½å­˜åœ¨äºå†…å­˜ä¸­, æ‰€ä»¥ dist ç›®å½•ä¸‹ä»€ä¹ˆéƒ½æ²¡æœ‰, åªæ˜¯æ–¹ä¾¿ HTML/JS æ–‡ä»¶ä¹‹é—´èƒ½å¤Ÿé€šè¿‡ dist/bundle.js è¿›è¡Œå…³è”, æˆ‘ä»¬è¿™é‡Œéœ€è¦ dist è¿™ä¸ªç›®å½•å å‘, ä»¥ä½¿å¾— Webpack å¯ä»¥ç²˜è¿ HTML å’Œ JS æ–‡ä»¶.</p>

<p><strong>.babelrc</strong></p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"presets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"@babel/preset-env"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"@babel/preset-react"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Babel ç›¸å…³çš„è®¾ç½®, å¯ä»¥è®©ä½ ä½¿ç”¨æœ€æ–°çš„ JavaScript è¯­æ³•, Babel ä¼šè‡ªåŠ¨æŠŠæœ€æ–°çš„è¯­æ³•è½¬æ¢æˆæ‰€æœ‰æµè§ˆå™¨å¯ä»¥æ‰§è¡Œçš„é™ˆæ—§è¯­æ³•, è®©ä½ å¼€å‘çš„æ—¶å€™ç”¨JavaScriptæœ€æ–°è¯­æ³•, åŒæ—¶åˆä¿è¯ç¼–è¯‘åçš„JSä»£ç å¯¹æµè§ˆå™¨çš„å…¼å®¹æ€§.</p>

<p>æ³¨æ„åœ¨ .babelrc é…ç½®å, å°±ä¸éœ€è¦åœ¨ package.json æ–‡ä»¶ä¸­é…ç½® babel é€‰é¡¹äº†.</p>

<p><strong>nodemon.json</strong></p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"ignore"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"dist/"</span><span class="p">,</span><span class="w"> </span><span class="s2">"client/*.js"</span><span class="p">],</span><span class="w">
  </span><span class="s2">"ext"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json js html"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<ul>
  <li>ignore è§„åˆ™çš„æ„æ€æ˜¯, å¿½ç•¥ dist ç›®å½•å’Œ client ç›®å½•ä¸‹çš„ JS æ–‡ä»¶å˜åŠ¨, é¿å…è¿™äº›JSæ–‡ä»¶å˜åŠ¨å¼•èµ·æœåŠ¡å™¨é‡å¯, JSæ–‡ä»¶çš„å˜åŠ¨ç”± Webpack çš„çƒ­æ›¿æ¢æœºåˆ¶æ¥æ§åˆ¶, æ¥è·å¾—æ›´æ–¹ä¾¿çš„ JS è‡ªåŠ¨åˆ·æ–°ä½“éªŒ</li>
  <li>ext è§„åˆ™çš„æ„æ€æ˜¯, ç›‘å¬é¡¹ç›®ç›®å½•ä¸‹æ‰€æœ‰ jsã€jsonã€htmlç»“å°¾çš„æ–‡ä»¶, è¿™äº›æ–‡ä»¶å˜åŠ¨åç«‹å³é‡å¯æœåŠ¡å™¨, ext è¿™ä¸ªè§„åˆ™éœ€è¦æ’é™¤ ignore è§„åˆ™çš„ä¾‹å¤–æƒ…å†µ</li>
</ul>

<p><strong>package.json</strong></p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"project"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="s2">"main"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index.js"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nodemon ./app.js"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"keywords"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="s2">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="s2">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ISC"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"dependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"body-parser"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.18.3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cookie-parser"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.4.3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"express"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^4.16.4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"multer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.4.1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"react"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^16.6.3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"react-dom"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^16.6.3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"react-hot-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^4.3.12"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"devDependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"@babel/core"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^7.2.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"@babel/preset-env"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^7.2.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"@babel/preset-react"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^7.0.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"babel-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^8.0.4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"css-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.0.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"less"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.9.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"less-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^4.1.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"nodemon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.18.7"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"reload"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.4.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"style-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.23.1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"webpack"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^4.27.1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"webpack-cli"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.1.2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"webpack-dev-middleware"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.4.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"webpack-dev-server"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.1.10"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"webpack-hot-middleware"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.24.3"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯è¢« npm/cnpm å‘½ä»¤è‡ªåŠ¨ç”Ÿæˆçš„, æˆ‘ä»¬åªç”¨çœ‹ scripts è¿™ä¸€æ®µ:</p>
<ul>
  <li><code class="highlighter-rouge">"start": "nodemon ./app.js"</code> è¿™å¥ä»£ç çš„æ„æ€æ˜¯, ç”± nodemon æ¥å¯åŠ¨ app.js , nodemon ä¼šç›‘å¬é¡¹ç›®çš„æ‰€æœ‰æ–‡ä»¶, åœ¨æ–‡ä»¶å˜åŠ¨åé‡å¯æœåŠ¡å™¨, é‡å¯æœåŠ¡å™¨çš„è§„åˆ™å— nodemon.json é…ç½®æ–‡ä»¶ä¸­çš„è§„åˆ™å½±å“</li>
</ul>

<p><strong>webpack.config.js</strong>
å¦‚æœä½ çœ‹åˆ°è¿™é‡Œäº†, ä½ ä¼šå‘ç°ä¸Šé¢çš„è¿™äº›é…ç½®ä¸€ç‚¹éƒ½ä¸å¤æ‚, å…¶å®æœ€å¤æ‚çš„å°±æ˜¯ webpack.config.js , ä½†æ˜¯å¦‚æœä½ ç†è§£äº†æˆ‘ä¸Šé¢è¯´çš„å·¥ä½œæµç¨‹, ä½ ä¼šå‘ç°ç†è§£ webpack.config.js çš„å†…å®¹ä¹Ÿæ˜¯éå¸¸è‡ªç„¶çš„:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">webpack</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'webpack'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">hotMiddlewareScript</span> <span class="o">=</span> <span class="s2">"webpack-hot-middleware/client?reload=true"</span><span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">entry</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">client</span><span class="p">:</span> <span class="p">[</span><span class="s2">"./client"</span><span class="p">,</span> <span class="nx">hotMiddlewareScript</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="na">mode</span><span class="p">:</span> <span class="s2">"development"</span><span class="p">,</span>
  <span class="na">module</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">rules</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.(</span><span class="sr">js|jsx</span><span class="se">)</span><span class="sr">$/</span><span class="p">,</span>
        <span class="na">exclude</span><span class="p">:</span> <span class="sr">/node_modules/</span><span class="p">,</span>
        <span class="na">use</span><span class="p">:</span> <span class="p">[</span><span class="s1">'babel-loader'</span><span class="p">]</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">less$/</span><span class="p">,</span>
        <span class="na">use</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="na">loader</span><span class="p">:</span> <span class="s2">"style-loader"</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="na">loader</span><span class="p">:</span> <span class="s2">"css-loader"</span><span class="p">,</span>
            <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
              <span class="na">sourceMap</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
              <span class="na">modules</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
              <span class="na">localIdentName</span><span class="p">:</span> <span class="s2">"[local]___[hash:base64:5]"</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="na">loader</span><span class="p">:</span> <span class="s2">"less-loader"</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="na">resolve</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">extensions</span><span class="p">:</span> <span class="p">[</span><span class="s1">'*'</span><span class="p">,</span> <span class="s1">'.js'</span><span class="p">,</span> <span class="s1">'.jsx'</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">'/dist'</span><span class="p">,</span>
    <span class="na">publicPath</span><span class="p">:</span> <span class="s2">"/"</span><span class="p">,</span>
    <span class="na">filename</span><span class="p">:</span> <span class="s1">'bundle.js'</span>
  <span class="p">},</span>
  <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span>
    <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">HotModuleReplacementPlugin</span><span class="p">(),</span>
    <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">NoEmitOnErrorsPlugin</span><span class="p">(),</span>
  <span class="p">],</span>
  <span class="na">devServer</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">hot</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<ul>
  <li>
    <p><code class="highlighter-rouge">const webpack = require('webpack');</code> å¯¼å…¥ webpack è¿™ä¸ªåº“</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">var hotMiddlewareScript = "webpack-hot-middleware/client?reload=true"</code> è¿™ä¸ªä»£ç éå¸¸é‡è¦, app.js å’Œ client/index.js éƒ½åŠ å…¥äº†å¯¹ webpack-hot-middleware è¿™ä¸ªä¸­é—´ä»¶çš„æ”¯æŒ, ä»¥å®ç° JS æ–‡ä»¶æ”¹åŠ¨åçš„çƒ­æ›¿æ¢æ”¯æŒ, è¿™å¥çš„æ„æ€æ˜¯, JSçƒ­æ›¿æ¢å¤±è´¥ä»¥åé‡æ–°åŠ è½½é¡µé¢, å¦‚æœè¿™å¥ä¸å†™, å¾ˆå¤šæƒ…å†µä¸‹, ä½ æ”¹ JS æ–‡ä»¶çš„å†…å®¹ä¼šå¯¼è‡´çƒ­æ›¿æ¢æœºåˆ¶ä¸ä¸€å®šæˆåŠŸ, æœ€ç»ˆå¯¼è‡´å³ä½¿ä¿®æ”¹äº†JSæ–‡ä»¶, æµè§ˆå™¨ä¹Ÿä¸ä¼šåˆ·æ–°é¡µé¢å†…å®¹</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">client: ["./client", hotMiddlewareScript]</code> ç”¨ä¸Šé¢çš„çƒ­æ›¿æ¢è§„åˆ™, ç›‘å¬ client ä¸‹æ‰€æœ‰æ–‡ä»¶, å¦‚æœ client ä¸‹çš„æ–‡ä»¶å˜åŠ¨å, webpackä¼šè‡ªåŠ¨é‡æ–°ç¼–è¯‘ã€æ‰“åŒ…å’Œçƒ­æ›¿æ¢, è®°ä½ JS/LESS æ–‡ä»¶çš„å˜åŠ¨å’Œæ›¿æ¢æ˜¯ç”± Webpack æ¥ç›‘å¬å’Œæ‰§è¡Œçš„, nodemon ä¸»è¦ç”¨äºç›‘å¬åç«¯ä»£ç ã€é…ç½®æ–‡ä»¶å’ŒHTMLé¡µé¢æ–‡ä»¶</p>
  </li>
  <li>
    <p>rules ç›¸å…³ä»£ç ä¸»è¦æ§åˆ¶ js/jsx æ–‡ä»¶çš„éœ€è¦é€šè¿‡ babel-loader æ¥è½¬æ¢ React JSXæ–‡ä»¶çš„ JavaScript è¯­æ³•, less æ–‡ä»¶è‡ªåŠ¨ä¼šè¢«ä¸‰ä¸ªæ’ä»¶ style-loaderã€css-loaderã€less-loader ä¾æ¬¡å¤„ç†, è‡ªåŠ¨æŠŠç¼–å†™çš„ Less æ–‡ä»¶è½¬æ¢æˆ CSS æ ·å¼, å¹¶ä¿è¯æ¯ä¸ªCSSç»„ä»¶çš„åå­—æœ‰ä¸€ä¸ªå”¯ä¸€çš„hashå€¼, é¿å…ä¸åŒç»„ä»¶ä¹‹é—´åŒæ ·çš„ class name äº’ç›¸å½±å“.</p>
  </li>
  <li>
    <p>resolve ç›¸å…³çš„ä»£ç ä¸»è¦æ§åˆ¶ JS import æ¨¡å—çš„æ—¶å€™, æŒ‡å¯¼ä»å“ªé‡Œæ‰¾è¿™äº› JS æ¨¡å—, æ›´ä¸“ä¸šçš„è®²è§£å¯ä»¥æŸ¥çœ‹ <a href="https://webpack.docschina.org/configuration/resolve/">webpack resolve</a></p>
  </li>
  <li>
    <p>output ç›¸å…³çš„ä»£ç æ§åˆ¶ JS/CSS ç¼–è¯‘åçš„æ–‡ä»¶åå’Œå­˜æ”¾çš„ç›®å½•, è¿™é‡Œå°±æ˜¯ dist/bundle.js</p>
  </li>
  <li>
    <p>plugins ç›¸å…³çš„ä»£ç , è¡¨ç¤ºåŠ è½½ HotModuleReplacementPlugin è¿™ä¸ªæ’ä»¶, é…åˆ app.jsã€client/index.js è¿›è¡Œ JS/CSS çƒ­æ›¿æ¢æ“ä½œ, NoEmitOnErrorsPlugin æ’ä»¶çš„ç›®çš„æ˜¯, å½“æ–‡ä»¶æœ‰è¯­æ³•é”™è¯¯æ—¶ä¸è¦åˆ·æ–°é¡µé¢, åªæ˜¯åœ¨ç»ˆç«¯é‡Œæ‰“å°é”™è¯¯</p>
  </li>
  <li>
    <p>devServer æœ€ä¸»è¦çš„é…ç½®å°±æ˜¯ <code class="highlighter-rouge">hot: true</code>, è¿˜æ˜¯å…³äºçƒ­æ›¿æ¢æ“ä½œçš„, ä½ çœ‹, ä¸ºäº†è®© JS/CSS çƒ­æ›¿æ¢æˆåŠŸ, é¦–å…ˆéœ€è¦ app.js ä½¿ç”¨ <code class="highlighter-rouge">app.use</code> ä»£ç ä½¿ç”¨çƒ­æ›¿æ¢ä¸­é—´ä»¶, å…¶æ¬¡ client/index.js ä¸­è¦é€šè¿‡ <code class="highlighter-rouge">module.hot.accept()</code> æ¥æ‰‹åŠ¨æ§åˆ¶JSæ¨¡å—æ˜¯å¦éœ€è¦çƒ­æ›¿æ¢, æœ€åè¿˜éœ€è¦åœ¨ webpack.config.js ä¸­é€šè¿‡ hotMiddlewareScriptã€ plugins å’Œ devServer ä¸‰ä¸ªå­—æ®µæ¥æ§åˆ¶, æœ€ç»ˆéœ€è¦è¿™5ä¸ªåœ°æ–¹å…±åŒè®¾ç½®æ¥è¾¾æˆçƒ­æ›¿æ¢çš„æ“ä½œ, å…¶å® Webpack çš„éš¾ç‚¹å°±åœ¨è¿™, é…ç½®å¤ªåˆ†æ•£, ä¸€å¤„æ²¡æœ‰è®¾ç½®å¯¹å°±æ²¡æ³•æ“ä½œ.</p>
  </li>
</ul>

<h4 id="å¯åŠ¨æœåŠ¡">å¯åŠ¨æœåŠ¡</h4>
<p>å¥½äº†, åˆ°ç›®å‰ä¸ºæ­¢, æ‰€æœ‰é…ç½®æ–‡ä»¶éƒ½æŠ˜è…¾å®Œäº†, æ‰§è¡Œä¸‹é¢å‘½ä»¤å°±å¯ä»¥å¯åŠ¨WebæœåŠ¡äº†:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm start
</code></pre></div></div>
<p>ç„¶åæ‰“å¼€ http://localhost:3000 å°±å¯ä»¥çœ‹åˆ°æ•ˆæœ, å°è¯•ä¿®æ”¹ä¸€ä¸‹ JSã€LESSã€HTMLç”šè‡³æœåŠ¡å™¨ä»£ç , çœ‹çœ‹æ˜¯ä¸æ˜¯å…¨æ ˆéƒ½è‡ªåŠ¨åˆ·æ–°äº†å‘¢?</p>

<p>Happy hacking!</p>

<h3 id="ç›¸å…³æŠ€æœ¯åšå®¢å‚è€ƒé“¾æ¥">ç›¸å…³æŠ€æœ¯åšå®¢å‚è€ƒé“¾æ¥</h3>
<p>æŠ˜è…¾è¿‡ç¨‹ä¸­é‡åˆ°çš„æŠ€æœ¯åšå®¢ä¹Ÿéå¸¸æœ‰å‚è€ƒä»·å€¼, ä¸‹é¢æ˜¯æˆ‘æŠ˜è…¾è¿‡ç¨‹ä¸­, ä¸»è¦å‚è€ƒçš„æŠ€æœ¯åšå®¢å’Œæˆ‘è§‰å¾—æ¯ä¸ªæŠ€æœ¯åšå®¢ä¸»è¦çš„å‚è€ƒä»·å€¼</p>

<table>
  <thead>
    <tr>
      <th>æŠ€æœ¯åšå®¢</th>
      <th>å‚è€ƒä»·å€¼</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://www.robinwieruch.de/minimal-react-webpack-babel-setup/">React + Webpack 4 + Babel 7 Setup Tutorial</a></td>
      <td>ä¸»è¦ä»‹ç»åœ¨ Webpack4 ä¸‹æ€ä¹ˆæˆåŠŸå®‰è£… Babel , ç½‘ä¸Šå¤§éƒ¨åˆ†çš„æ–‡ç« éƒ½æ˜¯åŸºäº Webpack3 å®‰è£…çš„, å„ç§ Babel ç›¸å…³çš„æŠ¥é”™, è€Œä¸”ä»é¡¹ç›®æ•´ä½“é…ç½®ä¸Šè®²çš„ä¹Ÿå¾ˆæ¸…æ™°æ˜“æ‡‚</td>
    </tr>
    <tr>
      <td><a href="http://acgtofe.com/posts/2016/02/full-live-reload-for-express-with-webpack">Expressç»“åˆWebpackçš„å…¨æ ˆè‡ªåŠ¨åˆ·æ–°</a></td>
      <td>æ€ä¹ˆåšåˆ° JS/CSS çƒ­æ›¿æ¢è®²çš„éå¸¸å¥½, æ¯”å¦‚ reload=true çš„æŠ€å·§, å…¶ä»–çš„æŠ€æœ¯åšå®¢å„ç§æŠ˜è…¾éƒ½ä¸æˆåŠŸ</td>
    </tr>
    <tr>
      <td><a href="http://www.ruanyifeng.com/blog/2016/06/css_modules.html">CSS Modules ç”¨æ³•æ•™ç¨‹</a></td>
      <td>æ€ä¹ˆåœ¨ React ä½¿ç”¨ CSS ç»„ä»¶çš„æ–¹æ¡ˆ</td>
    </tr>
    <tr>
      <td><a href="https://medium.com/@joseph0crick/react-css-modules-less-webpack-4-a50d902d0a3">React + CSS Modules + LESS + Webpack 4</a></td>
      <td>LESS ç›¸å…³é…ç½®å†™çš„æœ€ç®€å•æ˜“æ‡‚çš„æ–‡ç« </td>
    </tr>
  </tbody>
</table>

<h3 id="æœ€å">æœ€å</h3>
<p>å‰ç«¯è¿™ä¸ªæŠ€æœ¯åœˆæ˜¯æˆ‘çœ‹åˆ°çš„æœ€ä¸ºæ··ä¹±çš„æŠ€æœ¯åœˆ, å„ç§æ¡†æ¶å’Œå„ç§æ’ä»¶å±‚å‡ºä¸ç©·, å†™ä¸ªHello Worldä¹‹å‰å°±è¦æŠ˜è…¾ä¸€å¤§å †é…ç½®ç¯å¢ƒ.</p>

<p>å½“ç„¶, æˆ‘ä¹Ÿä»å‰ç«¯æŠ€æœ¯åœˆä¸­çœ‹åˆ°äº†åƒEmacsè¿™æ ·çš„æŠ˜è…¾æ°›å›´, æŠ€æœ¯åœˆå’Œäººä¸€æ ·, æŠ˜è…¾æ‰æœ‰æ´»åŠ›, æŠ˜è…¾æ‰èƒ½å­¦åˆ°æ›´å¤šçŸ¥è¯†, å› ä¸ºå½“ä½ æŠ˜è…¾ä¸€éä»¥å, ä¸ç®¡æŠ˜è…¾çš„å¤šä¹ˆå¤æ‚, ä¸€æ—¦ä½ è®°ä½, ä½ å°±ä¸ä¼šé‚£ä¹ˆéš¾äº†. å“ˆå“ˆå“ˆå“ˆ.</p>
:ET